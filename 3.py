import numpy as np
import pandas as pd
from sklearn.linear_model import LinearRegression
from sklearn.preprocessing import PolynomialFeatures
from sklearn.metrics import r2_score


X_glucose = np.array([4.0, 4.5, 5.0, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0, 8.5])
y_hemoglobin = np.array([130, 140, 147, 150, 151, 149, 145, 138, 130, 120])


X = X_glucose.reshape(-1, 1)
y = y_hemoglobin

print("Вихідні дані:")
df = pd.DataFrame({'Глюкоза (X)': X_glucose, 'Гемоглобін (Y)': y_hemoglobin})
print(df)
print("-" * 30)


poly = PolynomialFeatures(degree=2, include_bias=False)
X_poly = poly.fit_transform(X)


print("Трансформовані ознаки (Z1 = X та Z2 = X^2):")
print(pd.DataFrame(X_poly, columns=['X', 'X^2']).head())
print("-" * 30)


model = LinearRegression()
model.fit(X_poly, y)


a = model.intercept_  
b1 = model.coef_[0]   
b2 = model.coef_[1]   

print("--- 1. Обчислені Параметри Моделі ---")
print(f"Вільний член (a):     {a:.4f}")
print(f"Коефіцієнт b1 (при X): {b1:.4f}")
print(f"Коефіцієнт b2 (при X^2): {b2:.4f}")
print("-" * 30)


y_pred = model.predict(X_poly)


r2 = r2_score(y, y_pred)


print("--- 2. Оцінка Якості Моделі ---")
print(f"Коефіцієнт детермінації (R^2): {r2:.4f}")



























































































































































































































































































































